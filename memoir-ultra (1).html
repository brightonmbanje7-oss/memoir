<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Memoir Ultra ‚Ä¢ Premium Journal</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@300;400;600;700&family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@400;600;700;900&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --bg-primary: #0a0e27;
      --bg-secondary: #151934;
      --bg-elevated: #1e2442;
      --accent-gold: #d4af37;
      --accent-rose: #ff6b9d;
      --accent-cyan: #4ecdc4;
      --accent-lavender: #b794f6;
      --text-primary: #f8f9fa;
      --text-secondary: #b8bcc8;
      --text-tertiary: #6b7280;
      --glass: rgba(255, 255, 255, 0.03);
      --glass-border: rgba(255, 255, 255, 0.08);
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
      --shadow-md: 0 8px 24px rgba(0, 0, 0, 0.2);
      --shadow-lg: 0 16px 48px rgba(0, 0, 0, 0.3);
      --shadow-glow: 0 0 40px rgba(212, 175, 55, 0.4);
    }

    /* Theme Variants */
    [data-theme="aurora"] {
      --bg-primary: #0f1419;
      --bg-secondary: #1a1f2e;
      --accent-gold: #00f5d4;
      --accent-rose: #f15bb5;
      --accent-cyan: #00bbf9;
      --accent-lavender: #9b5de5;
    }

    [data-theme="ember"] {
      --bg-primary: #1a0f0a;
      --bg-secondary: #2d1810;
      --accent-gold: #ff6b35;
      --accent-rose: #ff9f1c;
      --accent-cyan: #ffbf69;
      --accent-lavender: #cb997e;
    }

    [data-theme="forest"] {
      --bg-primary: #0d1b1e;
      --bg-secondary: #1a2f35;
      --accent-gold: #8dd3bb;
      --accent-rose: #ff8ba7;
      --accent-cyan: #c9f0ff;
      --accent-lavender: #a8dadc;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'DM Sans', -apple-system, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
    }

    /* Animated Background */
    .animated-bg {
      position: fixed;
      inset: 0;
      z-index: 0;
      background: 
        radial-gradient(circle at 20% 50%, rgba(212, 175, 55, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255, 107, 157, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 40% 20%, rgba(78, 205, 196, 0.08) 0%, transparent 50%);
      animation: bgPulse 20s ease-in-out infinite;
    }

    @keyframes bgPulse {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 0.6; transform: scale(1.1); }
    }

    .noise-overlay {
      position: fixed;
      inset: 0;
      z-index: 1;
      opacity: 0.03;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
      pointer-events: none;
    }

    /* Floating Orbs */
    .orb {
      position: fixed;
      border-radius: 50%;
      filter: blur(60px);
      opacity: 0.15;
      pointer-events: none;
      z-index: 1;
      animation: float 30s ease-in-out infinite;
    }

    .orb-1 {
      width: 400px;
      height: 400px;
      background: var(--accent-gold);
      top: -200px;
      left: -200px;
      animation-delay: 0s;
    }

    .orb-2 {
      width: 300px;
      height: 300px;
      background: var(--accent-rose);
      bottom: -150px;
      right: -150px;
      animation-delay: 5s;
    }

    .orb-3 {
      width: 250px;
      height: 250px;
      background: var(--accent-cyan);
      top: 50%;
      right: 10%;
      animation-delay: 10s;
    }

    @keyframes float {
      0%, 100% {
        transform: translate(0, 0) scale(1);
      }
      33% {
        transform: translate(30px, -30px) scale(1.1);
      }
      66% {
        transform: translate(-20px, 20px) scale(0.9);
      }
    }

    /* Music Control Enhanced */
    .music-control {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: var(--glass);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      padding: 12px 16px;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: var(--shadow-md);
      z-index: 1000;
      transition: all 0.3s;
    }

    .music-control:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .music-btn {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      padding: 8px;
      border-radius: 8px;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .music-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: scale(1.1);
    }

    .track-info {
      display: flex;
      flex-direction: column;
      gap: 4px;
      min-width: 120px;
    }

    .track-name {
      color: var(--text-primary);
      font-size: 0.875rem;
      font-weight: 500;
    }

    .track-type {
      color: var(--text-secondary);
      font-size: 0.75rem;
    }

    .volume-control {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .volume-slider {
      width: 80px;
      height: 4px;
      border-radius: 2px;
      background: rgba(255, 255, 255, 0.1);
      outline: none;
      -webkit-appearance: none;
    }

    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--accent-gold);
      cursor: pointer;
    }

    .volume-slider::-moz-range-thumb {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--accent-gold);
      cursor: pointer;
      border: none;
    }

    /* Screens */
    .screen {
      position: fixed;
      inset: 0;
      z-index: 10;
      transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1), 
                  transform 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                  filter 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .screen.hidden {
      opacity: 0;
      pointer-events: none;
      transform: scale(0.95);
      filter: blur(10px);
    }

    /* Login Screen */
    #login-screen {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .login-box {
      background: var(--glass);
      backdrop-filter: blur(40px);
      border: 1px solid var(--glass-border);
      border-radius: 32px;
      padding: 64px 48px;
      max-width: 480px;
      width: 100%;
      box-shadow: var(--shadow-lg), 0 0 80px rgba(212, 175, 55, 0.1);
      position: relative;
      overflow: hidden;
      animation: fadeInUp 1s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(40px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .login-box::before {
      content: '';
      position: absolute;
      inset: -2px;
      background: linear-gradient(135deg, var(--accent-gold), var(--accent-rose), var(--accent-cyan));
      border-radius: 32px;
      opacity: 0;
      transition: opacity 0.6s;
      z-index: -1;
    }

    .login-box:hover::before {
      opacity: 0.1;
    }

    .brand-logo {
      text-align: center;
      margin-bottom: 48px;
      position: relative;
    }

    .brand-icon {
      font-size: 64px;
      display: inline-block;
      position: relative;
      animation: iconFloat 3s ease-in-out infinite;
    }

    @keyframes iconFloat {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-10px) rotate(5deg); }
    }

    .brand-icon::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 40px;
      height: 4px;
      background: var(--accent-gold);
      border-radius: 2px;
      opacity: 0.6;
      filter: blur(4px);
    }

    .brand-title {
      font-family: 'Playfair Display', serif;
      font-size: 2.75rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent-gold), var(--accent-rose));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-top: 16px;
      letter-spacing: -0.02em;
    }

    .brand-subtitle {
      font-size: 0.95rem;
      color: var(--text-secondary);
      margin-top: 8px;
      font-weight: 300;
      letter-spacing: 0.05em;
    }

    .input-group {
      position: relative;
      margin: 32px 0;
    }

    .input-field {
      width: 100%;
      padding: 18px 56px 18px 20px;
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid var(--glass-border);
      border-radius: 16px;
      color: var(--text-primary);
      font-size: 1.05rem;
      font-family: inherit;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .input-field:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.08);
      border-color: var(--accent-gold);
      box-shadow: 0 0 0 4px rgba(212, 175, 55, 0.1);
    }

    .input-icon {
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.25rem;
      cursor: pointer;
      transition: transform 0.3s;
    }

    .input-icon:hover {
      transform: translateY(-50%) scale(1.15);
    }

    .btn-primary {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, var(--accent-gold), var(--accent-rose));
      border: none;
      border-radius: 16px;
      color: white;
      font-size: 1.05rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      letter-spacing: 0.02em;
    }

    .btn-primary::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, var(--accent-rose), var(--accent-cyan));
      opacity: 0;
      transition: opacity 0.4s;
    }

    .btn-primary:hover::before {
      opacity: 1;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(212, 175, 55, 0.4);
    }

    .btn-primary:active {
      transform: translateY(0);
    }

    .btn-primary span {
      position: relative;
      z-index: 1;
    }

    /* Home Screen */
    #home-screen {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
    }

    .home-container {
      max-width: 900px;
      text-align: center;
      animation: fadeInUp 1s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .home-title {
      font-family: 'Playfair Display', serif;
      font-size: 4rem;
      font-weight: 900;
      background: linear-gradient(135deg, var(--accent-gold), var(--accent-rose), var(--accent-cyan));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 24px;
      line-height: 1.1;
      letter-spacing: -0.03em;
    }

    .home-desc {
      font-size: 1.3rem;
      color: var(--text-secondary);
      margin-bottom: 48px;
      line-height: 1.6;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .home-actions {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 64px;
    }

    .btn-large {
      padding: 20px 48px;
      font-size: 1.15rem;
      border-radius: 20px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
    }

    .btn-large::before {
      content: '';
      position: absolute;
      inset: 0;
      opacity: 0;
      transition: opacity 0.4s;
    }

    .btn-large:hover {
      transform: translateY(-4px);
    }

    .btn-large.primary {
      background: linear-gradient(135deg, var(--accent-gold), var(--accent-rose));
      color: white;
    }

    .btn-large.primary::before {
      background: linear-gradient(135deg, var(--accent-rose), var(--accent-cyan));
    }

    .btn-large.primary:hover::before {
      opacity: 1;
    }

    .btn-large.secondary {
      background: var(--glass);
      backdrop-filter: blur(20px);
      border-color: var(--glass-border);
      color: var(--text-primary);
    }

    .btn-large.secondary:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: var(--accent-gold);
    }

    .btn-large span {
      position: relative;
      z-index: 1;
    }

    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 24px;
      margin-top: 48px;
    }

    .feature-card {
      background: var(--glass);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: 24px;
      padding: 32px;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .feature-card::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, var(--accent-gold), var(--accent-rose));
      opacity: 0;
      transition: opacity 0.4s;
    }

    .feature-card:hover {
      transform: translateY(-8px);
      border-color: var(--accent-gold);
      box-shadow: var(--shadow-lg);
    }

    .feature-card:hover::before {
      opacity: 0.05;
    }

    .feature-icon {
      font-size: 2.5rem;
      margin-bottom: 16px;
      display: inline-block;
      position: relative;
      z-index: 1;
    }

    .feature-title {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--text-primary);
      position: relative;
      z-index: 1;
    }

    .feature-desc {
      font-size: 0.95rem;
      color: var(--text-secondary);
      line-height: 1.6;
      position: relative;
      z-index: 1;
    }

    /* App Screen */
    #app-screen {
      display: grid;
      grid-template-columns: 320px 1fr;
      height: 100vh;
    }

    .sidebar {
      background: var(--bg-secondary);
      border-right: 1px solid var(--glass-border);
      display: flex;
      flex-direction: column;
      position: relative;
      z-index: 100;
      transition: transform 0.3s;
    }

    .sidebar-header {
      padding: 24px;
      border-bottom: 1px solid var(--glass-border);
    }

    .sidebar-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.75rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent-gold), var(--accent-rose));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .sidebar-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 16px;
    }

    .stat-item {
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 12px;
      padding: 12px 8px;
      text-align: center;
    }

    .stat-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--accent-gold);
    }

    .stat-label {
      font-size: 0.75rem;
      color: var(--text-tertiary);
      margin-top: 4px;
    }

    .entries-section {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
    }

    .section-title {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 12px;
      padding: 0 8px;
    }

    .filter-pills {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 16px;
    }

    .filter-pill {
      padding: 6px 12px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 8px;
      font-size: 0.8rem;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.3s;
    }

    .filter-pill:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: var(--accent-gold);
      color: var(--accent-gold);
    }

    .entries-container {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .entry-card {
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      padding: 16px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .entry-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background: var(--accent-gold);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .entry-card:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateX(4px);
    }

    .entry-card:hover::before {
      opacity: 1;
    }

    .entry-card.active {
      background: rgba(212, 175, 55, 0.1);
      border-color: var(--accent-gold);
    }

    .entry-card.active::before {
      opacity: 1;
    }

    .entry-top {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 8px;
    }

    .entry-title {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 0.95rem;
    }

    .entry-date {
      font-size: 0.75rem;
      color: var(--text-tertiary);
      margin-top: 4px;
    }

    .entry-badges {
      display: flex;
      gap: 6px;
      font-size: 1.1rem;
    }

    .entry-preview {
      font-size: 0.85rem;
      color: var(--text-secondary);
      line-height: 1.5;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .entry-tags-list {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 12px;
    }

    .tag-chip {
      padding: 4px 8px;
      background: rgba(212, 175, 55, 0.15);
      border: 1px solid rgba(212, 175, 55, 0.3);
      border-radius: 6px;
      font-size: 0.7rem;
      color: var(--accent-gold);
    }

    .sidebar-footer {
      padding: 16px;
      border-top: 1px solid var(--glass-border);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .action-btn {
      padding: 12px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 12px;
      color: var(--text-primary);
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-family: inherit;
    }

    .action-btn:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: var(--accent-gold);
      transform: translateY(-2px);
    }

    .action-btn.primary {
      background: linear-gradient(135deg, var(--accent-gold), var(--accent-rose));
      border: none;
      color: white;
      font-weight: 600;
    }

    .action-btn.primary:hover {
      box-shadow: 0 4px 16px rgba(212, 175, 55, 0.3);
    }

    .main-area {
      display: flex;
      flex-direction: column;
      overflow: hidden;
      position: relative;
    }

    .main-header {
      padding: 24px 32px;
      border-bottom: 1px solid var(--glass-border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--bg-secondary);
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .menu-toggle {
      display: none;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 8px;
      border-radius: 8px;
      transition: all 0.3s;
    }

    .menu-toggle:hover {
      background: var(--glass);
    }

    .header-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--text-primary);
    }

    .header-actions {
      display: flex;
      gap: 12px;
    }

    .icon-btn {
      padding: 10px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 10px;
      cursor: pointer;
      font-size: 1.25rem;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .icon-btn:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateY(-2px);
    }

    .icon-btn.playing {
      background: rgba(212, 175, 55, 0.2);
      border-color: var(--accent-gold);
    }

    .main-content {
      flex: 1;
      overflow-y: auto;
      padding: 48px 32px;
    }

    .entry-view {
      max-width: 800px;
      margin: 0 auto;
      animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .entry-header {
      margin-bottom: 32px;
    }

    .entry-meta {
      display: flex;
      gap: 16px;
      color: var(--text-tertiary);
      font-size: 0.9rem;
      margin-bottom: 16px;
    }

    .entry-view-title {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--text-primary);
      line-height: 1.2;
    }

    .entry-body {
      font-size: 1.1rem;
      line-height: 1.8;
      color: var(--text-secondary);
    }

    .entry-image-display {
      width: 100%;
      border-radius: 16px;
      margin-bottom: 24px;
      box-shadow: var(--shadow-md);
    }

    /* Modals */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
      padding: 20px;
    }

    .modal.show {
      opacity: 1;
      pointer-events: all;
    }

    .modal-content {
      background: var(--bg-secondary);
      border: 1px solid var(--glass-border);
      border-radius: 24px;
      padding: 40px;
      max-width: 600px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: var(--shadow-lg);
      transform: scale(0.9);
      transition: transform 0.3s;
    }

    .modal.show .modal-content {
      transform: scale(1);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 32px;
    }

    .modal-title {
      font-family: 'Playfair Display', serif;
      font-size: 2rem;
      font-weight: 700;
      color: var(--text-primary);
    }

    .close-btn {
      font-size: 1.5rem;
      cursor: pointer;
      padding: 8px;
      border-radius: 8px;
      transition: all 0.3s;
      line-height: 1;
    }

    .close-btn:hover {
      background: var(--glass);
      transform: rotate(90deg);
    }

    .form-group {
      margin-bottom: 24px;
    }

    .form-label {
      display: block;
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 8px;
    }

    .form-input {
      width: 100%;
      padding: 14px 16px;
      background: var(--glass);
      border: 2px solid var(--glass-border);
      border-radius: 12px;
      color: var(--text-primary);
      font-size: 1rem;
      font-family: inherit;
      transition: all 0.3s;
    }

    .form-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.08);
      border-color: var(--accent-gold);
    }

    .form-textarea {
      min-height: 200px;
      resize: vertical;
      font-family: 'Crimson Pro', serif;
      font-size: 1.05rem;
      line-height: 1.6;
    }

    .mood-selector {
      display: flex;
      gap: 12px;
      margin-top: 8px;
    }

    .mood-btn {
      flex: 1;
      padding: 12px;
      background: var(--glass);
      border: 2px solid var(--glass-border);
      border-radius: 12px;
      font-size: 1.5rem;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .mood-btn:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateY(-2px);
    }

    .mood-btn.selected {
      background: rgba(212, 175, 55, 0.2);
      border-color: var(--accent-gold);
    }

    .tags-wrapper {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      padding: 12px;
      background: var(--glass);
      border: 2px solid var(--glass-border);
      border-radius: 12px;
      min-height: 50px;
      align-items: center;
    }

    .tag-item {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: rgba(212, 175, 55, 0.2);
      border: 1px solid var(--accent-gold);
      border-radius: 8px;
      font-size: 0.85rem;
      color: var(--accent-gold);
    }

    .tag-remove {
      cursor: pointer;
      font-size: 1.2rem;
      line-height: 1;
      transition: transform 0.2s;
    }

    .tag-remove:hover {
      transform: scale(1.3);
    }

    #tag-input {
      flex: 1;
      min-width: 100px;
      border: none;
      background: transparent;
      color: var(--text-primary);
      font-size: 0.95rem;
      outline: none;
    }

    .image-upload-area {
      padding: 32px;
      background: var(--glass);
      border: 2px dashed var(--glass-border);
      border-radius: 12px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
    }

    .image-upload-area:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: var(--accent-gold);
    }

    .upload-icon {
      font-size: 2.5rem;
      margin-bottom: 12px;
    }

    .upload-text {
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    #image-preview {
      max-width: 100%;
      border-radius: 12px;
      margin-top: 16px;
      display: none;
    }

    .modal-actions {
      display: flex;
      gap: 12px;
      margin-top: 32px;
    }

    .btn-secondary {
      flex: 1;
      padding: 14px;
      background: var(--glass);
      border: 2px solid var(--glass-border);
      border-radius: 12px;
      color: var(--text-primary);
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-family: inherit;
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: var(--accent-gold);
    }

    .btn-primary-modal {
      flex: 1;
      padding: 14px;
      background: linear-gradient(135deg, var(--accent-gold), var(--accent-rose));
      border: none;
      border-radius: 12px;
      color: white;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-family: inherit;
    }

    .btn-primary-modal:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(212, 175, 55, 0.3);
    }

    /* Premium Modal */
    .premium-features {
      display: grid;
      gap: 20px;
      margin: 32px 0;
    }

    .premium-feature {
      display: flex;
      gap: 16px;
      padding: 20px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      transition: all 0.3s;
    }

    .premium-feature:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateX(4px);
    }

    .premium-icon {
      font-size: 2rem;
      flex-shrink: 0;
    }

    .premium-details h3 {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 6px;
    }

    .premium-details p {
      font-size: 0.9rem;
      color: var(--text-secondary);
      line-height: 1.5;
    }

    .premium-fab {
      position: fixed;
      bottom: 24px;
      left: 24px;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, var(--accent-gold), var(--accent-rose));
      border: none;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: var(--shadow-lg);
      transition: all 0.3s;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .premium-fab:hover {
      transform: scale(1.1);
      box-shadow: var(--shadow-glow);
    }

    /* Confetti Animation */
    @keyframes confetti-fall {
      to {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
      }
    }

    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      background: var(--accent-gold);
      top: -10px;
      z-index: 9999;
      animation: confetti-fall 3s ease-out forwards;
      pointer-events: none;
    }

    /* Responsive */
    @media (max-width: 1024px) {
      #app-screen {
        grid-template-columns: 1fr;
      }

      .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        bottom: 0;
        width: 320px;
        transform: translateX(-100%);
        z-index: 1000;
        box-shadow: var(--shadow-lg);
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .menu-toggle {
        display: block;
      }

      .home-title {
        font-size: 3rem;
      }

      .premium-fab {
        bottom: 80px;
      }
    }

    @media (max-width: 640px) {
      .home-title {
        font-size: 2.5rem;
      }

      .home-desc {
        font-size: 1.1rem;
      }

      .btn-large {
        padding: 16px 32px;
        font-size: 1rem;
      }

      .features-grid {
        grid-template-columns: 1fr;
      }

      .main-content {
        padding: 24px 16px;
      }

      .entry-view-title {
        font-size: 2rem;
      }

      .modal-content {
        padding: 24px;
      }

      .music-control {
        flex-direction: column;
        align-items: flex-start;
        bottom: 16px;
        right: 16px;
        left: 16px;
      }
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-secondary);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--glass-border);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.2);
    }
  </style>
</head>
<body data-theme="midnight">
  <!-- Background Elements -->
  <div class="animated-bg"></div>
  <div class="noise-overlay"></div>
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div class="orb orb-3"></div>

  <!-- Music Control -->
  <div class="music-control">
    <button class="music-btn" id="prev-track" title="Previous Track">‚èÆÔ∏è</button>
    <button class="music-btn" id="play-pause" title="Play/Pause">‚ñ∂Ô∏è</button>
    <button class="music-btn" id="next-track" title="Next Track">‚è≠Ô∏è</button>
    <div class="track-info">
      <div class="track-name" id="track-name">Chill Ambient</div>
      <div class="track-type" id="track-type">Lofi Beats</div>
    </div>
    <div class="volume-control">
      <span>üîä</span>
      <input type="range" class="volume-slider" id="volume-slider" min="0" max="100" value="30">
    </div>
  </div>

  <!-- Login Screen -->
  <div class="screen" id="login-screen">
    <div class="login-box">
      <div class="brand-logo">
        <div class="brand-icon">‚ú®</div>
        <h1 class="brand-title">Memoir</h1>
        <p class="brand-subtitle">Your Personal Journal, Elevated</p>
      </div>
      
      <div class="input-group">
        <input 
          type="password" 
          class="input-field" 
          id="password-input" 
          placeholder="Enter your password"
          autocomplete="current-password"
        />
        <span class="input-icon" id="toggle-password">üëÅÔ∏è</span>
      </div>
      
      <button class="btn-primary" id="login-button">
        <span>Unlock Your Memoir</span>
      </button>
    </div>
  </div>

  <!-- Home Screen -->
  <div class="screen hidden" id="home-screen">
    <div class="home-container">
      <h1 class="home-title">Welcome Back</h1>
      <p class="home-desc">Your thoughts, memories, and moments‚Äîbeautifully preserved in one place.</p>
      
      <div class="home-actions">
        <button class="btn-large primary" id="start-writing">
          <span>‚úçÔ∏è Start Writing</span>
        </button>
        <button class="btn-large secondary" id="explore-premium">
          <span>‚ú® Explore Premium</span>
        </button>
      </div>

      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">üé®</div>
          <h3 class="feature-title">Beautiful Themes</h3>
          <p class="feature-desc">Switch between stunning color schemes to match your mood.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">üîí</div>
          <h3 class="feature-title">Private & Secure</h3>
          <p class="feature-desc">Your entries are encrypted and stored locally on your device.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">üìä</div>
          <h3 class="feature-title">Track Your Journey</h3>
          <p class="feature-desc">Visualize your writing habits with insightful statistics.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- App Screen -->
  <div class="screen hidden" id="app-screen">
    <div class="sidebar">
      <div class="sidebar-header">
        <h2 class="sidebar-title">My Entries</h2>
        <div class="sidebar-stats">
          <div class="stat-item">
            <div class="stat-value" id="total-entries">0</div>
            <div class="stat-label">Entries</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="word-count">0</div>
            <div class="stat-label">Words</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="streak-count">0</div>
            <div class="stat-label">Streak</div>
          </div>
        </div>
      </div>

      <div class="entries-section">
        <div class="section-title">Filter by Tag</div>
        <div class="filter-pills" id="filter-pills"></div>
        
        <div class="section-title">All Entries</div>
        <div class="entries-container" id="entries-container"></div>
      </div>

      <div class="sidebar-footer">
        <button class="action-btn primary" id="new-entry-btn">
          <span>‚úçÔ∏è</span>
          <span>New Entry</span>
        </button>
        <button class="action-btn" id="home-button">
          <span>üè†</span>
          <span>Home</span>
        </button>
        <button class="action-btn" id="logout-button">
          <span>üö™</span>
          <span>Logout</span>
        </button>
      </div>
    </div>

    <div class="main-area">
      <div class="main-header">
        <div class="header-left">
          <div class="menu-toggle" id="menu-toggle">‚ò∞</div>
          <h1 class="header-title" id="entry-title">Select an entry</h1>
        </div>
        <div class="header-actions">
          <button class="icon-btn" id="theme-toggle" title="Change Theme">üé®</button>
          <button class="icon-btn" id="font-toggle" title="Change Font">üî§</button>
          <button class="icon-btn" id="music-toggle" title="Toggle Music">üéµ</button>
        </div>
      </div>

      <div class="main-content">
        <div class="entry-view">
          <div class="entry-header">
            <div class="entry-meta">
              <span>üìÖ Select an entry to view</span>
            </div>
          </div>
          <div class="entry-body" id="entry-content">
            <p style="color: var(--text-tertiary); text-align: center; padding: 60px 20px;">
              Choose an entry from the sidebar or create a new one to get started.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Premium FAB -->
  <button class="premium-fab" id="premium-fab" title="Upgrade to Premium">üëë</button>

  <!-- Entry Modal -->
  <div class="modal" id="entry-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">New Entry</h2>
        <span class="close-btn" id="cancel-entry">‚úï</span>
      </div>

      <div class="form-group">
        <label class="form-label">Title (optional)</label>
        <input type="text" class="form-input" id="entry-title-input" placeholder="Give your entry a title..." />
      </div>

      <div class="form-group">
        <label class="form-label">Your Thoughts</label>
        <textarea class="form-input form-textarea" id="entry-textarea" placeholder="What's on your mind?"></textarea>
      </div>

      <div class="form-group">
        <label class="form-label">How are you feeling? üòä (Premium)</label>
        <div class="mood-selector">
          <button class="mood-btn" data-mood="amazing" title="Amazing">üòÑ</button>
          <button class="mood-btn" data-mood="happy" title="Happy">üòä</button>
          <button class="mood-btn" data-mood="neutral" title="Neutral">üòê</button>
          <button class="mood-btn" data-mood="sad" title="Sad">üò¢</button>
          <button class="mood-btn" data-mood="anxious" title="Anxious">üò∞</button>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Tags (Premium)</label>
        <div class="tags-wrapper" id="tags-wrapper">
          <input type="text" id="tag-input" placeholder="Add tags..." />
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Attach Image (Premium)</label>
        <div class="image-upload-area" id="image-upload-area">
          <div class="upload-icon">üì∑</div>
          <div class="upload-text">Click to upload an image</div>
        </div>
        <input type="file" id="image-input" accept="image/*" style="display: none;" />
        <img id="image-preview" alt="Preview" />
      </div>

      <div class="modal-actions">
        <button class="btn-secondary" id="cancel-entry-btn">Cancel</button>
        <button class="btn-primary-modal" id="save-entry">Save Entry</button>
      </div>
    </div>
  </div>

  <!-- Premium Modal -->
  <div class="modal" id="premium-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">‚ú® Upgrade to Premium</h2>
        <span class="close-btn" id="close-premium">‚úï</span>
      </div>

      <div class="premium-features">
        <div class="premium-feature">
          <div class="premium-icon">üòä</div>
          <div class="premium-details">
            <h3>Mood Tracking</h3>
            <p>Track your emotional journey and see patterns over time.</p>
          </div>
        </div>

        <div class="premium-feature">
          <div class="premium-icon">üè∑Ô∏è</div>
          <div class="premium-details">
            <h3>Tags & Organization</h3>
            <p>Organize entries with custom tags and powerful filtering.</p>
          </div>
        </div>

        <div class="premium-feature">
          <div class="premium-icon">üì∑</div>
          <div class="premium-details">
            <h3>Image Attachments</h3>
            <p>Add photos and memories to your journal entries.</p>
          </div>
        </div>

        <div class="premium-feature">
          <div class="premium-icon">‚≠ê</div>
          <div class="premium-details">
            <h3>Star Favorites</h3>
            <p>Mark important entries and quickly access them later.</p>
          </div>
        </div>

        <div class="premium-feature">
          <div class="premium-icon">üé®</div>
          <div class="premium-details">
            <h3>Exclusive Themes</h3>
            <p>Access premium color schemes and customization options.</p>
          </div>
        </div>

        <div class="premium-feature">
          <div class="premium-icon">üìä</div>
          <div class="premium-details">
            <h3>Advanced Analytics</h3>
            <p>Get detailed insights into your writing habits and trends.</p>
          </div>
        </div>
      </div>

      <button class="btn-primary-modal" onclick="upgradePlan()">
        Upgrade Now - $9.99/month
      </button>
    </div>
  </div>

  <!-- Audio Elements - Multiple Tracks -->
  <audio id="audio-player" loop></audio>

  <script>
    // ‚ïê‚ïê‚ïê STATE ‚ïê‚ïê‚ïê
    const state = {
      isLoggedIn: false,
      isPremium: false,
      entries: [],
      currentIndex: 0,
      selectedMood: null,
      selectedTags: [],
      allTags: new Set(),
      currentTheme: 'midnight',
      currentFont: 'crimson',
      isMusicPlaying: false,
      currentTrackIndex: 0
    };

    // ‚ïê‚ïê‚ïê MUSIC TRACKS ‚ïê‚ïê‚ïê
    const musicTracks = [
      {
        name: "Lofi Study",
        type: "Chill Beats",
        // Using Web Audio API to generate ambient sound
        generateAudio: () => generateAmbientTrack(440, 0.3, 'sine')
      },
      {
        name: "Rain Ambience",
        type: "Nature Sounds",
        generateAudio: () => generateRainSound()
      },
      {
        name: "Piano Dreams",
        type: "Soft Piano",
        generateAudio: () => generatePianoTrack()
      },
      {
        name: "Ocean Waves",
        type: "Beach Vibes",
        generateAudio: () => generateOceanWaves()
      },
      {
        name: "Meditation",
        type: "Ambient Pad",
        generateAudio: () => generateAmbientTrack(220, 0.4, 'triangle')
      }
    ];

    // ‚ïê‚ïê‚ïê AUDIO GENERATION ‚ïê‚ïê‚ïê
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    let currentAudioSource = null;

    function generateAmbientTrack(frequency, volume, waveType) {
      // Stop previous source
      if (currentAudioSource) {
        try {
          currentAudioSource.stop();
        } catch (e) {}
      }

      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      const filter = audioContext.createBiquadFilter();

      oscillator.type = waveType;
      oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
      
      filter.type = 'lowpass';
      filter.frequency.setValueAtTime(800, audioContext.currentTime);

      gainNode.gain.setValueAtTime(0, audioContext.currentTime);
      gainNode.gain.linearRampToValueAtTime(volume, audioContext.currentTime + 2);

      oscillator.connect(filter);
      filter.connect(gainNode);
      gainNode.connect(audioContext.destination);

      oscillator.start();
      currentAudioSource = oscillator;

      // Add subtle frequency modulation
      setInterval(() => {
        if (state.isMusicPlaying) {
          const variation = Math.random() * 20 - 10;
          oscillator.frequency.setValueAtTime(
            frequency + variation,
            audioContext.currentTime
          );
        }
      }, 3000);
    }

    function generateRainSound() {
      if (currentAudioSource) {
        try {
          currentAudioSource.stop();
        } catch (e) {}
      }

      const bufferSize = 2 * audioContext.sampleRate;
      const noiseBuffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
      const output = noiseBuffer.getChannelData(0);

      for (let i = 0; i < bufferSize; i++) {
        output[i] = Math.random() * 2 - 1;
      }

      const whiteNoise = audioContext.createBufferSource();
      whiteNoise.buffer = noiseBuffer;
      whiteNoise.loop = true;

      const filter = audioContext.createBiquadFilter();
      filter.type = 'lowpass';
      filter.frequency.value = 1000;

      const gainNode = audioContext.createGain();
      gainNode.gain.value = 0.15;

      whiteNoise.connect(filter);
      filter.connect(gainNode);
      gainNode.connect(audioContext.destination);

      whiteNoise.start();
      currentAudioSource = whiteNoise;
    }

    function generatePianoTrack() {
      if (currentAudioSource) {
        try {
          currentAudioSource.stop();
        } catch (e) {}
      }

      const notes = [261.63, 293.66, 329.63, 349.23, 392.00, 440.00]; // C major scale
      let noteIndex = 0;

      function playNote() {
        if (!state.isMusicPlaying) return;

        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();

        oscillator.type = 'sine';
        oscillator.frequency.setValueAtTime(notes[noteIndex], audioContext.currentTime);

        gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.5);

        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);

        oscillator.start();
        oscillator.stop(audioContext.currentTime + 1.5);

        noteIndex = (noteIndex + 1) % notes.length;
        setTimeout(playNote, 2000 + Math.random() * 2000);
      }

      playNote();
      currentAudioSource = { stop: () => {} }; // Dummy source
    }

    function generateOceanWaves() {
      if (currentAudioSource) {
        try {
          currentAudioSource.stop();
        } catch (e) {}
      }

      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      const filter = audioContext.createBiquadFilter();

      oscillator.type = 'sine';
      oscillator.frequency.setValueAtTime(80, audioContext.currentTime);

      filter.type = 'lowpass';
      filter.frequency.setValueAtTime(400, audioContext.currentTime);

      gainNode.gain.setValueAtTime(0, audioContext.currentTime);

      oscillator.connect(filter);
      filter.connect(gainNode);
      gainNode.connect(audioContext.destination);

      oscillator.start();
      currentAudioSource = oscillator;

      // Simulate wave motion
      function waveMotion() {
        if (!state.isMusicPlaying) return;
        
        gainNode.gain.linearRampToValueAtTime(0.25, audioContext.currentTime + 3);
        gainNode.gain.linearRampToValueAtTime(0.05, audioContext.currentTime + 6);
        
        setTimeout(waveMotion, 6000);
      }
      waveMotion();
    }

    // ‚ïê‚ïê‚ïê MUSIC CONTROLS ‚ïê‚ïê‚ïê
    function playTrack(index) {
      state.currentTrackIndex = index;
      const track = musicTracks[index];
      
      $('track-name').textContent = track.name;
      $('track-type').textContent = track.type;
      
      track.generateAudio();
      state.isMusicPlaying = true;
      $('play-pause').textContent = '‚è∏Ô∏è';
    }

    function toggleMusic() {
      if (audioContext.state === 'suspended') {
        audioContext.resume();
      }

      if (state.isMusicPlaying) {
        // Pause
        if (currentAudioSource) {
          try {
            currentAudioSource.stop();
          } catch (e) {}
        }
        state.isMusicPlaying = false;
        $('play-pause').textContent = '‚ñ∂Ô∏è';
        $('music-toggle').classList.remove('playing');
      } else {
        // Play
        playTrack(state.currentTrackIndex);
        $('music-toggle').classList.add('playing');
      }
    }

    function nextTrack() {
      state.currentTrackIndex = (state.currentTrackIndex + 1) % musicTracks.length;
      if (state.isMusicPlaying) {
        playTrack(state.currentTrackIndex);
      }
    }

    function prevTrack() {
      state.currentTrackIndex = (state.currentTrackIndex - 1 + musicTracks.length) % musicTracks.length;
      if (state.isMusicPlaying) {
        playTrack(state.currentTrackIndex);
      }
    }

    // ‚ïê‚ïê‚ïê SHORTCUTS ‚ïê‚ïê‚ïê
    const $ = id => document.getElementById(id);
    const $$ = sel => document.querySelectorAll(sel);

    const modals = {
      entry: $('entry-modal'),
      premium: $('premium-modal')
    };

    // ‚ïê‚ïê‚ïê STORAGE ‚ïê‚ïê‚ïê
    function saveData() {
      localStorage.setItem('memoirData', JSON.stringify({
        entries: state.entries,
        isPremium: state.isPremium,
        theme: state.currentTheme,
        font: state.currentFont
      }));
    }

    function loadData() {
      const data = localStorage.getItem('memoirData');
      if (data) {
        const parsed = JSON.parse(data);
        state.entries = parsed.entries || [];
        state.isPremium = parsed.isPremium || false;
        state.currentTheme = parsed.theme || 'midnight';
        state.currentFont = parsed.font || 'crimson';
        document.body.setAttribute('data-theme', state.currentTheme);
        document.body.setAttribute('data-font', state.currentFont);
      }
    }

    // ‚ïê‚ïê‚ïê AUTHENTICATION ‚ïê‚ïê‚ïê
    function login() {
      const password = $('password-input').value;
      if (password === 'memoir123' || password.length > 0) {
        state.isLoggedIn = true;
        loadData();
        showScreen('home');
      } else {
        alert('Please enter a password');
      }
    }

    function logout() {
      state.isLoggedIn = false;
      showScreen('login');
      if (currentAudioSource) {
        try {
          currentAudioSource.stop();
        } catch (e) {}
      }
      state.isMusicPlaying = false;
    }

    // ‚ïê‚ïê‚ïê SCREEN MANAGEMENT ‚ïê‚ïê‚ïê
    function showScreen(name) {
      $$('.screen').forEach(s => s.classList.add('hidden'));
      setTimeout(() => {
        $(`${name}-screen`).classList.remove('hidden');
        
        if (name === 'app') {
          updateStats();
          renderEntries();
          loadAllTags();
          renderFilterPills();
          
          if (state.entries.length > 0) {
            loadEntry(0);
          }
        }
      }, 100);
    }

    // ‚ïê‚ïê‚ïê MODALS ‚ïê‚ïê‚ïê
    function showModal(name) {
      modals[name].classList.add('show');
    }

    function hideModal(name) {
      modals[name].classList.remove('show');
    }

    // ‚ïê‚ïê‚ïê THEME & FONT ‚ïê‚ïê‚ïê
    const themes = ['midnight', 'aurora', 'ember', 'forest'];
    const fonts = ['crimson', 'sans', 'mono'];

    function cycleTheme() {
      const idx = themes.indexOf(state.currentTheme);
      state.currentTheme = themes[(idx + 1) % themes.length];
      document.body.setAttribute('data-theme', state.currentTheme);
      saveData();
    }

    function cycleFont() {
      const idx = fonts.indexOf(state.currentFont);
      state.currentFont = fonts[(idx + 1) % fonts.length];
      document.body.setAttribute('data-font', state.currentFont);
      saveData();
    }

    // ‚ïê‚ïê‚ïê PREMIUM ‚ïê‚ïê‚ïê
    function upgradePlan() {
      state.isPremium = !state.isPremium;
      saveData();
      hideModal('premium');
      alert(state.isPremium ? '‚ú® Premium activated! Enjoy all features.' : 'Premium deactivated.');
      renderEntries();
    }

    // ‚ïê‚ïê‚ïê STATS ‚ïê‚ïê‚ïê
    function updateStats() {
      $('total-entries').textContent = state.entries.length;
      
      const totalWords = state.entries.reduce((sum, entry) => {
        return sum + (entry.content?.split(/\s+/).length || 0);
      }, 0);
      $('word-count').textContent = totalWords;
      
      $('streak-count').textContent = calculateStreak();
    }

    function calculateStreak() {
      if (state.entries.length === 0) return 0;
      
      const today = new Date().toDateString();
      const sortedEntries = [...state.entries].sort((a, b) => 
        new Date(b.timestamp) - new Date(a.timestamp)
      );
      
      let streak = 0;
      let currentDate = new Date();
      
      for (const entry of sortedEntries) {
        const entryDate = new Date(entry.timestamp).toDateString();
        const checkDate = currentDate.toDateString();
        
        if (entryDate === checkDate) {
          streak++;
          currentDate.setDate(currentDate.getDate() - 1);
        } else {
          break;
        }
      }
      
      return streak;
    }

    function loadAllTags() {
      state.allTags.clear();
      state.entries.forEach(entry => {
        if (entry.tags) {
          entry.tags.forEach(tag => state.allTags.add(tag));
        }
      });
    }

    // ‚ïê‚ïê‚ïê CONFETTI ‚ïê‚ïê‚ïê
    function celebrate() {
      for (let i = 0; i < 30; i++) {
        setTimeout(() => {
          const confetti = document.createElement('div');
          confetti.className = 'confetti';
          confetti.style.left = Math.random() * 100 + '%';
          confetti.style.background = ['var(--accent-gold)', 'var(--accent-rose)', 'var(--accent-cyan)'][Math.floor(Math.random() * 3)];
          confetti.style.animationDelay = Math.random() * 0.5 + 's';
          document.body.appendChild(confetti);
          
          setTimeout(() => confetti.remove(), 3000);
        }, i * 50);
      }
    }

    // ‚ïê‚ïê‚ïê ENTRIES ‚ïê‚ïê‚ïê
    function renderEntries() {
      const container = $('entries-container');
      container.innerHTML = '';
      
      if (state.entries.length === 0) {
        container.innerHTML = '<p style="color: var(--text-tertiary); padding: 20px; text-align: center;">No entries yet. Create your first one!</p>';
        return;
      }
      
      state.entries.forEach((entry, i) => {
        const card = document.createElement('div');
        card.className = `entry-card${i === state.currentIndex ? ' active' : ''}`;
        
        const mood = entry.mood ? getMoodEmoji(entry.mood) : '';
        const star = entry.starred && state.isPremium ? '‚≠ê' : '';
        const tags = entry.tags && entry.tags.length > 0 && state.isPremium
          ? `<div class="entry-tags-list">${entry.tags.map(t => `<span class="tag-chip">${t}</span>`).join('')}</div>`
          : '';
        
        card.innerHTML = `
          <div class="entry-top">
            <div>
              <div class="entry-title">${entry.title || 'Untitled Entry'}</div>
              <div class="entry-date">${entry.date}</div>
            </div>
            <div class="entry-badges">${star}${mood}</div>
          </div>
          <div class="entry-preview">${entry.content}</div>
          ${tags}
        `;
        
        card.onclick = () => loadEntry(i);
        container.appendChild(card);
      });
    }

    function getMoodEmoji(mood) {
      const moods = {
        'amazing': 'üòÑ',
        'happy': 'üòä',
        'neutral': 'üòê',
        'sad': 'üò¢',
        'anxious': 'üò∞'
      };
      return moods[mood] || 'üòê';
    }

    function loadEntry(idx) {
      state.currentIndex = idx;
      const entry = state.entries[idx];
      
      $('entry-title').textContent = entry.title || 'Untitled Entry';
      
      let content = entry.content || '';
      if (entry.image && state.isPremium) {
        content = `<img src="${entry.image}" class="entry-image-display" /><br><br>` + content;
      }
      
      $('entry-content').innerHTML = content.replace(/\n/g, '<br>');
      renderEntries();
      
      const sidebar = document.querySelector('.sidebar');
      if (window.innerWidth < 1024) {
        sidebar.classList.remove('open');
      }
    }

    function renderFilterPills() {
      if (!state.isPremium || state.allTags.size === 0) {
        $('filter-pills').innerHTML = '';
        return;
      }
      
      const container = $('filter-pills');
      container.innerHTML = '';
      
      state.allTags.forEach(tag => {
        const pill = document.createElement('div');
        pill.className = 'filter-pill';
        pill.textContent = tag;
        container.appendChild(pill);
      });
    }

    // ‚ïê‚ïê‚ïê NEW ENTRY ‚ïê‚ïê‚ïê
    function openNewEntry() {
      showModal('entry');
      $('entry-title-input').value = '';
      $('entry-textarea').value = '';
      $('tag-input').value = '';
      $('image-preview').style.display = 'none';
      
      state.selectedMood = null;
      state.selectedTags = [];
      
      $$('.mood-btn').forEach(btn => btn.classList.remove('selected'));
      renderTagChips();
    }

    function saveNewEntry() {
      const title = $('entry-title-input').value.trim();
      const content = $('entry-textarea').value.trim();
      
      if (!content) {
        alert('Please write something before saving.');
        return;
      }

      const date = new Date();
      const entry = {
        title,
        content,
        date: date.toLocaleString('en-US', {
          month: 'short',
          day: 'numeric',
          year: 'numeric',
          hour: '2-digit',
          minute: '2-digit'
        }),
        timestamp: date.toISOString(),
        mood: state.isPremium ? state.selectedMood : null,
        tags: state.isPremium ? [...state.selectedTags] : [],
        starred: false
      };

      if (state.isPremium) {
        const imgInput = $('image-input');
        if (imgInput.files[0]) {
          const reader = new FileReader();
          reader.onload = (e) => {
            entry.image = e.target.result;
            finalizeEntry(entry);
          };
          reader.readAsDataURL(imgInput.files[0]);
          return;
        }
      }
      
      finalizeEntry(entry);
    }

    function finalizeEntry(entry) {
      state.entries.unshift(entry);
      saveData();
      loadAllTags();
      updateStats();
      renderEntries();
      hideModal('entry');
      loadEntry(0);
      celebrate();
    }

    function renderTagChips() {
      const wrapper = $('tags-wrapper');
      const input = $('tag-input');
      
      $$('.tag-item').forEach(item => item.remove());
      
      state.selectedTags.forEach(tag => {
        const chip = document.createElement('div');
        chip.className = 'tag-item';
        chip.innerHTML = `
          ${tag}
          <span class="tag-remove" onclick="removeTag('${tag}')">√ó</span>
        `;
        wrapper.insertBefore(chip, input);
      });
    }

    function addTag() {
      const input = $('tag-input');
      const value = input.value.trim();
      
      if (value && !state.selectedTags.includes(value)) {
        state.selectedTags.push(value);
        renderTagChips();
        input.value = '';
      }
    }

    window.removeTag = function(tag) {
      state.selectedTags = state.selectedTags.filter(t => t !== tag);
      renderTagChips();
    };

    window.upgradePlan = upgradePlan;

    // ‚ïê‚ïê‚ïê EVENT LISTENERS ‚ïê‚ïê‚ïê
    $('login-button').onclick = login;
    $('password-input').onkeypress = (e) => {
      if (e.key === 'Enter') login();
    };

    $('toggle-password').onclick = () => {
      const input = $('password-input');
      const type = input.type === 'password' ? 'text' : 'password';
      input.type = type;
      $('toggle-password').textContent = type === 'password' ? 'üëÅÔ∏è' : 'üôà';
    };

    $('start-writing').onclick = () => {
      showScreen('app');
      // Auto-start music
      setTimeout(() => {
        if (audioContext.state === 'suspended') {
          audioContext.resume();
        }
        playTrack(0);
      }, 500);
    };

    $('explore-premium').onclick = () => showModal('premium');
    $('premium-fab').onclick = () => showModal('premium');
    $('close-premium').onclick = () => hideModal('premium');

    $('logout-button').onclick = logout;
    $('home-button').onclick = () => showScreen('home');
    $('theme-toggle').onclick = cycleTheme;
    $('font-toggle').onclick = cycleFont;
    $('music-toggle').onclick = toggleMusic;

    // Music controls
    $('play-pause').onclick = toggleMusic;
    $('next-track').onclick = nextTrack;
    $('prev-track').onclick = prevTrack;
    $('volume-slider').oninput = (e) => {
      if (currentAudioSource && currentAudioSource.gainNode) {
        const volume = e.target.value / 100;
        currentAudioSource.gainNode.gain.setValueAtTime(volume, audioContext.currentTime);
      }
    };

    $('new-entry-btn').onclick = openNewEntry;
    $('save-entry').onclick = saveNewEntry;
    $('cancel-entry').onclick = () => hideModal('entry');
    $('cancel-entry-btn').onclick = () => hideModal('entry');

    $('menu-toggle').onclick = () => {
      document.querySelector('.sidebar').classList.toggle('open');
    };

    $$('.mood-btn').forEach(btn => {
      btn.onclick = function() {
        $$('.mood-btn').forEach(b => b.classList.remove('selected'));
        this.classList.add('selected');
        state.selectedMood = this.getAttribute('data-mood');
      };
    });

    $('tag-input').onkeypress = (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        addTag();
      }
    };

    $('image-upload-area').onclick = () => $('image-input').click();
    $('image-input').onchange = (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (ev) => {
          const preview = $('image-preview');
          preview.src = ev.target.result;
          preview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      }
    };

    // Close modals on overlay click
    modals.premium.onclick = (e) => {
      if (e.target === modals.premium) hideModal('premium');
    };
    modals.entry.onclick = (e) => {
      if (e.target === modals.entry) hideModal('entry');
    };

    // Close sidebar on outside click
    document.onclick = (e) => {
      const sidebar = document.querySelector('.sidebar');
      const menuBtn = $('menu-toggle');
      
      if (window.innerWidth < 1024 && 
          sidebar.classList.contains('open') &&
          !sidebar.contains(e.target) && 
          !menuBtn.contains(e.target)) {
        sidebar.classList.remove('open');
      }
    };

    // Keyboard shortcuts
    document.onkeydown = (e) => {
      if (e.key === 'Escape') {
        if (modals.entry.classList.contains('show')) hideModal('entry');
        if (modals.premium.classList.contains('show')) hideModal('premium');
      }
      
      if ((e.ctrlKey || e.metaKey) && e.key === 'n' && state.isLoggedIn) {
        e.preventDefault();
        openNewEntry();
      }
    };

    // ‚ïê‚ïê‚ïê INIT ‚ïê‚ïê‚ïê
    setTimeout(() => $('password-input').focus(), 100);
  </script>
</body>
</html>